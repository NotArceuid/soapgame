import{K as I,L as D,M as S,N as L,O as A,P as O,Q as T,R as y,h as B,T as w,m as b,U as Y,V as N,W as U,o as k,X as x,Y as $,Z as C,_ as F,$ as Z,a0 as q,a1 as z,a2 as G,u as K,t as Q,a3 as V,a4 as W,S as X,a5 as j}from"./CzwFf6xN.js";class ee{anchor;#t=new Map;#s=new Map;#e=new Map;#a=new Set;#i=!0;constructor(e,t=!0){this.anchor=e,this.#i=t}#r=()=>{var e=I;if(this.#t.has(e)){var t=this.#t.get(e),s=this.#s.get(t);if(s)D(s),this.#a.delete(t);else{var i=this.#e.get(t);i&&(this.#s.set(t,i.effect),this.#e.delete(t),i.fragment.lastChild.remove(),this.anchor.before(i.fragment),s=i.effect)}for(const[a,d]of this.#t){if(this.#t.delete(a),a===e)break;const r=this.#e.get(d);r&&(S(r.effect),this.#e.delete(d))}for(const[a,d]of this.#s){if(a===t||this.#a.has(a))continue;const r=()=>{if(Array.from(this.#t.values()).includes(a)){var h=document.createDocumentFragment();T(d,h),h.append(A()),this.#e.set(a,{effect:d,fragment:h})}else S(d);this.#a.delete(a),this.#s.delete(a)};this.#i||!s?(this.#a.add(a),L(d,r,!1)):r()}}};#n=e=>{this.#t.delete(e);const t=Array.from(this.#t.values());for(const[s,i]of this.#e)t.includes(s)||(S(i.effect),this.#e.delete(s))};ensure(e,t){var s=I,i=y();if(t&&!this.#s.has(e)&&!this.#e.has(e))if(i){var a=document.createDocumentFragment(),d=A();a.append(d),this.#e.set(e,{effect:O(()=>t(d)),fragment:a})}else this.#s.set(e,O(()=>t(this.anchor)));if(this.#t.set(s,e),i){for(const[r,c]of this.#s)r===e?s.skipped_effects.delete(c):s.skipped_effects.add(c);for(const[r,c]of this.#e)r===e?s.skipped_effects.delete(c.effect):s.skipped_effects.add(c.effect);s.oncommit(this.#r),s.ondiscard(this.#n)}else B&&(this.anchor=w),this.#r()}}let m=!1;function H(f){var e=m;try{return m=!1,[f(),m]}finally{m=e}}function te(f,e,t,s){var i=!Q||(t&V)!==0,a=(t&G)!==0,d=(t&W)!==0,r=s,c=!0,h=()=>(c&&(c=!1,r=d?K(s):s),r),u;if(a){var R=X in f||j in f;u=F(f,e)?.set??(R&&e in f?n=>f[e]=n:void 0)}var _,P=!1;a?[_,P]=H(()=>f[e]):_=f[e],_===void 0&&s!==void 0&&(_=h(),u&&(i&&Z(),u(_)));var o;if(i?o=()=>{var n=f[e];return n===void 0?h():(c=!0,n)}:o=()=>{var n=f[e];return n!==void 0&&(r=void 0),n===void 0?r:n},i&&(t&q)===0)return o;if(u){var E=f.$$legacy;return(function(n,v){return arguments.length>0?((!i||!v||E||P)&&u(v?o():n),n):o()})}var g=!1,l=((t&z)!==0?k:C)(()=>(g=!1,o()));a&&b(l);var M=N;return(function(n,v){if(arguments.length>0){const p=v?b(l):i&&a?$(n):n;return Y(l,p),g=!0,r!==void 0&&(r=p),n}return x&&g||(M.f&U)!==0?l.v:b(l)})}export{ee as B,te as p};
